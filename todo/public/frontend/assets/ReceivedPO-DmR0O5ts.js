var K=(E,m,r)=>new Promise((g,p)=>{var c=o=>{try{n(r.next(o))}catch(u){p(u)}},f=o=>{try{n(r.throw(o))}catch(u){p(u)}},n=o=>o.done?g(o.value):Promise.resolve(o.value).then(c,f);n((r=r.apply(E,m)).next())});import{r as a,w as Y,o as Z,a as x,c as y,b as e,l as D,v,x as ee,p as te,y as w,B as le,t as i,F as se,z as oe,n as k}from"./index-CaZ8Fn9-.js";const ae={class:"flex items-center justify-between mb-6"},re=["disabled"],ne={key:0,class:"w-5 h-5 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ue={key:1},ie={key:2},de={class:"bg-white shadow-md rounded-lg p-4 mb-4 flex flex-wrap gap-4 items-end"},pe=["disabled"],ce={class:"bg-gray-50 rounded-lg p-4 mb-5 flex flex-wrap gap-3 shadow-sm"},fe={key:0,class:"text-red-600 font-semibold text-center mb-6",role:"alert"},be={class:"overflow-x-auto rounded-lg shadow-md"},xe={class:"min-w-full bg-white border-separate border-spacing-0"},ye={class:"px-4 py-3"},ve={class:"px-4 py-3 font-semibold text-blue-700"},me={class:"px-4 py-3"},ge={class:"px-4 py-3"},he={class:"px-4 py-3"},_e={class:"px-4 py-3"},we={class:"px-4 py-3"},ke={class:"px-4 py-3 text-right font-mono text-green-600"},Se={class:"px-2 py-3 text-center"},Ce={class:"px-2 py-3 text-center"},Pe={class:"px-2 py-3 text-center"},Oe={class:"px-2 py-3 text-center"},Ne={class:"px-2 py-3 text-center"},Ve={class:"px-2 py-3 text-center"},De={class:"px-4 py-3"},Ee={key:0},j=50,Re={__name:"ReceivedPO",setup(E){const m=a(""),r=a(""),g=a(""),p=a(""),c=a(""),f=a(""),n=a(""),o=a(""),u=a([]),b=a(!1),S=a(!1),P=a(null);let h=0,_=!1;function H(s,t=300){let l;return(...N)=>{l&&clearTimeout(l),l=setTimeout(()=>s(...N),t)}}function G(){const s=[];return m.value&&r.value&&s.push([m.value,"like",`%${r.value}%`]),g.value&&s.push(["creation",">=",g.value]),p.value&&s.push(["creation","<=",p.value]),c.value&&s.push(["order_number","like",`%${c.value}%`]),f.value&&s.push(["plant_code","like",`%${f.value}%`]),n.value&&s.push(["buyer_name","like",`%${n.value}%`]),o.value&&s.push(["supplier_code","like",`%${o.value}%`]),s}function C(s=!1){return K(this,null,function*(){if(!(b.value||S.value||_&&s)){s?S.value=!0:(b.value=!0,h=0,_=!1,u.value=[]),P.value=null;try{const t=G(),l=t.length?`&filters=${encodeURIComponent(JSON.stringify(t))}`:"",N=`/api/resource/Received PO?fields=["name","order_type","order_number","order_date","plant_code","total_amount","supplier_code","buyer_name","modified"]&limit_page_length=${j}&limit_start=${h}&order_by=modified desc${l}`,V=yield fetch(N,{credentials:"same-origin"});if(!V.ok)throw new Error(`API Error: ${V.status}`);const O=yield V.json();if(!O.data)throw new Error("Invalid API response");O.data.length<j&&(_=!0);const $=O.data.map((d,X)=>{var R,T,A,F,B,I,L,M,z;return{id:(R=d.name)!=null?R:`row-${h+X+1}`,type:(T=d.order_type)!=null?T:"-",order_number:(A=d.order_number)!=null?A:"-",order_date:(F=d.order_date)!=null?F:"-",plant:(B=d.plant_code)!=null?B:"-",supplier:(I=d.buyer_name)!=null?I:"-",supplier_code:(L=d.supplier_code)!=null?L:"-",po_amt:(M=d.total_amount)!=null?M:"-",version:"-",vw:!1,ak:!1,as:!1,gr:!1,in:!1,pd:!1,timestamp:(z=d.modified)!=null?z:"-"}});s?u.value.push(...$):u.value=$,h+=O.data.length}catch(t){P.value=t.message||"Could not fetch purchase orders.",s||(u.value=[])}finally{b.value=!1,S.value=!1}}})}function U(){h=0,_=!1,C(!1)}const J=H(()=>{h=0,_=!1,C(!1)},300);Y([c,f,n,o],()=>{J()});function Q(){m.value="",r.value="",g.value="",p.value="",c.value="",f.value="",n.value="",o.value="",h=0,_=!1,u.value=[],C(!1)}function W(s){const t=s.target;!S.value&&!b.value&&!_&&t.scrollHeight-t.scrollTop-t.clientHeight<100&&C(!0)}Z(()=>{C(!1)});function q(){alert("Export not implemented yet.")}return(s,t)=>(x(),y("div",{class:"p-10 bg-gradient-to-br from-blue-50 via-white to-gray-100 min-h-screen overflow-auto",ref:"scrollContainer",onScroll:W,style:{"max-height":"90vh"}},[e("div",ae,[t[9]||(t[9]=e("div",null,[e("h1",{class:"text-4xl font-extrabold text-blue-700 tracking-wide mb-2"},"Received POs"),e("p",{class:"text-gray-500 text-lg"},"Overview of your vendorâ€™s purchase orders.")],-1)),e("button",{class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded shadow ml-4 flex items-center gap-2",onClick:Q,disabled:b.value,title:"Refresh List"},[b.value?(x(),y("svg",ne,t[8]||(t[8]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l5-5-5-5v4a12 12 0 00-8 8z"},null,-1)]))):D("",!0),b.value?(x(),y("span",ie,"Loading...")):(x(),y("span",ue,"Refresh"))],8,re)]),e("div",de,[v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>m.value=l),class:"border border-blue-200 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"Search By"},t[10]||(t[10]=[te('<option value="">Search By</option><option value="order_number">PO Number</option><option value="plant_code">Plant Code</option><option value="supplier_code">Supplier Code</option><option value="buyer_name">Supplier Name</option>',5)]),512),[[ee,m.value]]),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>r.value=l),type:"text",placeholder:"Search...",class:"border border-blue-200 rounded px-3 py-2 w-44 focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"Search Term",onKeyup:le(U,["enter"]),autocomplete:"off"},null,544),[[w,r.value]]),v(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>g.value=l),type:"date",class:"border border-blue-200 rounded px-3 py-2 w-44 focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"From Date"},null,512),[[w,g.value]]),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>p.value=l),type:"date",class:"border border-blue-200 rounded px-3 py-2 w-44 focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"To Date"},null,512),[[w,p.value]]),e("button",{onClick:U,class:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded shadow transition","aria-label":"Search",disabled:b.value}," Search ",8,pe),e("button",{class:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded shadow transition",onClick:q,"aria-label":"Export"}," Export ")]),e("div",ce,[t[11]||(t[11]=e("span",{class:"pt-2 text-gray-700 font-medium"},"All Orders -",-1)),v(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>c.value=l),type:"text",placeholder:"PO NO..",class:"border border-gray-200 rounded px-3 py-2 w-48 focus:outline-none focus:ring-2 focus:ring-blue-200","aria-label":"PO Number Filter",autocomplete:"off"},null,512),[[w,c.value]]),v(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l),type:"text",placeholder:"PLANT CODE..",class:"border border-gray-200 rounded px-3 py-2 w-48 focus:outline-none focus:ring-2 focus:ring-blue-200","aria-label":"Plant Code Filter",autocomplete:"off"},null,512),[[w,f.value]]),v(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>n.value=l),type:"text",placeholder:"SUPPLIER NAME..",class:"border border-gray-200 rounded px-3 py-2 w-48 focus:outline-none focus:ring-2 focus:ring-blue-200","aria-label":"Supplier Name Filter",autocomplete:"off"},null,512),[[w,n.value]]),v(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>o.value=l),type:"text",placeholder:"SUPPLIER CODE..",class:"border border-gray-200 rounded px-3 py-2 w-48 focus:outline-none focus:ring-2 focus:ring-blue-200","aria-label":"Supplier Code Filter",autocomplete:"off"},null,512),[[w,o.value]])]),P.value?(x(),y("div",fe,i(P.value),1)):D("",!0),e("div",be,[e("table",xe,[t[15]||(t[15]=e("thead",null,[e("tr",{class:"bg-blue-200 text-blue-900 text-sm uppercase tracking-wider border-b-2 border-blue-300"},[e("th",{class:"px-4 py-3 text-left"},"ID"),e("th",{class:"px-4 py-3 text-left"},"Type"),e("th",{class:"px-4 py-3 text-left"},"Order Number"),e("th",{class:"px-4 py-3 text-left"},"Order Date"),e("th",{class:"px-4 py-3 text-left"},"Plant"),e("th",{class:"px-4 py-3 text-left"},"Supplier"),e("th",{class:"px-4 py-3 text-left"},"Supplier Code"),e("th",{class:"px-4 py-3 text-right"},"PO Amt"),e("th",{class:"px-4 py-3 text-center"},"Ver."),e("th",{class:"px-2 py-3 text-center"},"VW"),e("th",{class:"px-2 py-3 text-center"},"AK"),e("th",{class:"px-2 py-3 text-center"},"AS"),e("th",{class:"px-2 py-3 text-center"},"GR"),e("th",{class:"px-2 py-3 text-center"},"IN"),e("th",{class:"px-2 py-3 text-center"},"PD"),e("th",{class:"px-4 py-3 text-left"},"Timestamp"),e("th",{class:"px-4 py-3 text-center"},"Actions")])],-1)),e("tbody",null,[(x(!0),y(se,null,oe(u.value,l=>(x(),y("tr",{key:l.id,class:"hover:bg-blue-50 transition border-b"},[e("td",ye,i(l.id),1),e("td",ve,i(l.type),1),e("td",me,i(l.order_number),1),e("td",ge,i(l.order_date),1),e("td",he,i(l.plant),1),e("td",_e,i(l.supplier),1),e("td",we,i(l.supplier_code),1),e("td",ke,i(l.po_amt),1),t[12]||(t[12]=e("td",{class:"px-4 py-3 text-center"},"-",-1)),e("td",Se,[e("span",{class:k([l.vw?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",Ce,[e("span",{class:k([l.ak?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",Pe,[e("span",{class:k([l.as?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",Oe,[e("span",{class:k([l.gr?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",Ne,[e("span",{class:k([l.in?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",Ve,[e("span",{class:k([l.pd?"bg-blue-600":"bg-gray-200","inline-block h-4 w-4 rounded-full"])},null,2)]),e("td",De,i(l.timestamp),1),t[13]||(t[13]=e("td",{class:"px-4 py-3 text-center"},[e("button",{class:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-all shadow font-semibold"},"View")],-1))]))),128)),S.value?(x(),y("tr",Ee,t[14]||(t[14]=[e("td",{colspan:"17",class:"text-center py-4 text-blue-600 font-semibold"},"Loading more...",-1)]))):D("",!0)])])])],544))}};export{Re as default};
//# sourceMappingURL=ReceivedPO-DmR0O5ts.js.map
